name: Continuous Integration

on: 
  push:
    tags:
    - '*'
jobs:
    ci:
        name: build and release go binaries
        runs-on: ubuntu-latest
        steps:
          - name: checkout code
            uses: actions/checkout@v2
          - name: build linux binary
            run: make PLATFORM=linux/amd64
          - name: rename linux binary
            run: |
              mv ./bin/serialize-env-json ./bin/serialize-env-json_linux_amd64
          - name: build windows binary
            run: make PLATFORM=windows/amd64
          - name: rename windows binary
            run: |
              mv ./bin/serialize-env-json.exe ./bin/serialize-env-json_win64.exe
          - name: build darwin binary
            run: make PLATFORM=darwin/amd64
          - name: rename darwin binary
            run: |
              mv ./bin/serialize-env-json ./bin/serialize-env-json_darwin_amd64
          - name: Realase
            uses: softprops/action-gh-release@v1
             with:
              files: |
                Release.txt
                LICENSE
